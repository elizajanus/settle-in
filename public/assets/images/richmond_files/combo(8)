YUI.add("flickr-groups-unfave-fetcher",function(e,r){"use strict";e.namespace("ModelFetchers")["flickr-groups-unfave"]={run:function(s,o){return e.Promise.all([o.callAPI("flickr.groups.unfave",s),o.getModelRegistry("person-groups-models")]).then(this._processResponse,e.FetcherErrorLogger(r))},_processResponse:function(e){}}},"@VERSION@",{requires:["flickr-promise","flickr-promise"],optional:["person-groups-models","api-helper"]});YUI.add("flickr-people-getGroupsWithStatus-fetcher",function(e,t){"use strict";e.namespace("ListFetchers")["flickr-people-getGroupsWithStatus"]={run:function(s,i){var r=this,o={extras:e.APIHelper.request.getRebootGroupExtras()+", icon_urls, date_activity, date_last_viewed",user_id:s.id,status:s.status};return s.id!==i.getViewer().nsid&&(o.public_only=1,o.status="2,3,4"),e.Promise.all([i.callAPI("flickr.people.getGroupsWithStatus",o,!0),i.getModelRegistry("person-groups-models"),i.getModelRegistry("group-models"),i.getModelRegistry("group-activity-models")]).then(function(e){return r._processResponse(e,s)},e.FetcherErrorLogger(t))},_processResponse:function(t,s){var i,r=t[0],o=t[1],a=t[2],u=t[3],d=r.groups,l=s.id,p={},n=[];if(d)return e.Array.each(d,function(t,r){var o,d,l,p=a.parseGroupModel(s.id,s.pathAlias,t);o=a.addOrUpdate(p),n.push(o),t.viewDates?(d="0"!==t.viewDates.pool?e.moment(t.viewDates.pool,"X"):u.getDefaultViewedDate(),(l="0"!==t.viewDates.discussions?e.moment(t.viewDates.discussions,"X"):u.getDefaultViewedDate()).isValid()||(l=u.getDefaultViewedDate()),d.isValid()||(d=u.getDefaultViewedDate())):(d=u.getDefaultViewedDate(),l=u.getDefaultViewedDate()),i={id:p.id,viewedPool:d,viewedDiscussions:l,group:o},u.addOrUpdate(i)}),p={id:l,memberCount:r.members?r.members:null,moderatorCount:0,adminCount:0,invitedCount:0},p[s.attribute]=n,o.exists(l)?o.setValue(l,s.attribute,p[s.attribute]):o.add(p),p[s.attribute]}}},"@VERSION@",{requires:["flickr-promise","api-helper"],optional:["person-groups-models","group-models"]});YUI.add("person-groups-models",function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{read:function(t){return e.ModelFetchers["flickr-people-getInfo"].run(t,this.appContext)},faveGroup:function(t,r){return e.ModelFetchers["flickr-groups-fave"].run(t,r)},unfaveGroup:function(t,r){return e.ModelFetchers["flickr-groups-unfave"].run(t,r)}},faveGroup:function(e){var t=this,r=e.group_id,o=e.user_id;return this.remote.faveGroup(e,this.appContext).then(null,function(){t.appContext.getModel("group-models",r).then(function(e){t.getValue(o,"groupsFaved").removeFromList(r)})}),this.appContext.getModel("group-models",r).then(function(e){t.getValue(o,"groupsFaved").appendToList(e)})},unfaveGroup:function(e){var t=e.group_id,r=e.user_id,o=this;return this.remote.unfaveGroup(e,this.appContext).then(null,function(){o.appContext.getModel("group-models",t).then(function(e){o.getValue(r,"groupsFaved").appendToList(e)})}),this.appContext.getModel("group-models",t).then(function(e){o.getValue(r,"groupsFaved").removeFromList(t)})},attributes:{id:{},memberCount:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)}},moderatorCount:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)}},adminCount:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)}},invitedCount:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)}},groups:{isListProxy:!0,pageFetch:{listFetcher:e.ListFetchers["flickr-groups-pools-getGroups"]}},groupsAdministered:{isListProxy:!0,pageFetch:{listFetcher:e.ListFetchers["flickr-people-getGroupsWithStatus"]}},groupsModerated:{isListProxy:!0,pageFetch:{listFetcher:e.ListFetchers["flickr-people-getGroupsWithStatus"]}},groupsBelongingTo:{isListProxy:!0,pageFetch:{listFetcher:e.ListFetchers["flickr-people-getGroupsWithStatus"]}},groupsFaved:{isListProxy:!0,pageFetch:{listFetcher:e.ListFetchers["flickr-people-getGroupsWithStatus"]}}}})},"@VERSION@",{requires:["flickr-model-registry","flickr-promise","flickr-groups-pools-getGroups-fetcher","flickr-people-getInfo-fetcher","flickr-groups-fave-fetcher","flickr-groups-unfave-fetcher","flickr-people-getGroupsWithStatus-fetcher"]});YUI.add("flickr-photos-getContext-fetcher",function(e,o){"use strict";e.namespace("ListFetchers")["flickr-photos-getContext"]={run:function(t,s){var r=this;return e.Promise.all([s.callAPI("flickr.photos.getContext",this._processParams(t,s),!0),s.getModelRegistry("photostream-models"),s.getModelRegistry("photo-models"),s.getModelRegistry("photo-engagement-models"),s.getModelRegistry("photo-stats-models")]).then(function(e){return r._processResponse(e,t)},e.FetcherErrorLogger(o))},_processParams:function(o,t){var s;return s={photo_id:o.photoId,num_prev:o.numNext,num_next:o.numPrev,extras:e.APIHelper.request.getRebootPhotoExtras()},o.viewAs&&(s.view_as=o.viewAs),o.orderBy&&(s.order_by=o.orderBy),s},_processResponse:function(o,t){var s,r,n,p,a,i,h=o[0],l=o[1],d=o[2],g=o[3],u=o[4],m=[],c=[],x=d.proxy(t.photoId),y=x.getValue("owner"),M=[];return s=h.prevphotos,r=h.nextphotos,c=e.APIHelper.response.parsePhotos({photos:s.photo,existingPerson:y,photoModelRegistry:d,photoEngagementModelRegistry:g,photoStatsModelRegistry:u}),m=e.APIHelper.response.parsePhotos({photos:r.photo,existingPerson:y,photoModelRegistry:d,photoEngagementModelRegistry:g,photoStatsModelRegistry:u}),p=l.getValue(t.id,"photoContextList"),a=!!p.hasMinBoundary&&p.hasMinBoundary(),i=!!p.hasMaxBoundary&&p.hasMaxBoundary(),n=p.getList(),M=e.APIHelper.response.addOrReplaceListByContext({model:x,next:c,prev:m.reverse(),hasMin:a,hasMax:i,current:n,numNext:t.numNext,numPrev:t.numPrev}),l.setValue(t.id,"photoContextList",M),{next:c,previous:m.reverse()}}}},"@VERSION@",{requires:["flickr-promise","api-helper"],optional:["photostream-models","photo-models","photo-engagement-models","photo-stats-models"]});YUI.add("flickr-photos-getPerms-fetcher",function(e,r){"use strict";e.namespace("ModelFetchers")["flickr-photos-getPerms"]={run:function(s,i){var o={photo_id:s.id},t=this;return e.Promise.all([i.callAPI("flickr.photos.getPerms",o),i.getModelRegistry("photo-privacy-models")]).then(function(e){return t._processResponse(e,s)},e.FetcherErrorLogger(r))},_processResponse:function(e,r){var s,i=e[0],o=e[1];s={id:r.id,isPublic:i.perms.ispublic,isVisibleByFriends:i.perms.isfriend,isVisibleByFamily:i.perms.isfamily,permAddMeta:i.perms.permaddmeta,permComment:i.perms.permcomment},o.addOrUpdate(s)}}},"@VERSION@",{requires:["flickr-promise","api-helper"],optional:["photo-privacy-models"]});YUI.add("flickr-photos-setPerms-updater",function(e,r){"use strict";e.namespace("ModelUpdaters")["flickr-photos-setPerms"]={run:function(s,o){var t=this;return s.nsid=o.getViewer().nsid,e.Promise.all([o.callAPI("flickr.photos.setPerms",s),o.getModelRegistry("photostream-models")]).then(function(e){return t._processResponse(e,s)},e.FetcherErrorLogger(r))},_processResponse:function(e,r){var s=e[0],o=e[1];if(o.attributeSearch({normalizedId:r.nsid},!0).forEach(function(e){o.remove(e)}),r.full_response)return s.photoIdsSent=r.photo_ids,s}}},"@VERSION@",{requires:["flickr-promise"]});YUI.add("photo-privacy-models",function(e){function i(e){i.superclass.constructor.call(this,e)}e.Models[this.name]=i,e.extend(i,e.FlickrModelRegistry,{name:this.name,remote:{read:function(i){return e.ModelFetchers["flickr-photos-getInfo"].run(i,this.appContext)},update:function(i,t){var r;return r={photo_id:i,is_public:this.getValue(i,"isPublic"),is_friend:this.getValue(i,"isVisibleByFriends"),is_family:this.getValue(i,"isVisibleByFamily"),perm_addmeta:this.getValue(i,"permAddMeta"),perm_comment:this.getValue(i,"permComment")},e.ModelUpdaters["flickr-photos-setPerms"].run(r,this.appContext)},batchUpdate:function(i,t){var r;switch(!0){case"privacy"in t&&"commenting"in t&&"addMeta"in t:r={photo_ids:i,is_public:t.privacy.isPublic,is_friend:t.privacy.isVisibleByFriends,is_family:t.privacy.isVisibleByFamily,perm_addmeta:t.addMeta,perm_comment:t.commenting};break;case"privacy"in t&&"commenting"in t:r={photo_ids:i,is_public:t.privacy.isPublic,is_friend:t.privacy.isVisibleByFriends,is_family:t.privacy.isVisibleByFamily,perm_comment:t.commenting};break;case"privacy"in t&&"addMeta"in t:r={photo_ids:i,is_public:t.privacy.isPublic,is_friend:t.privacy.isVisibleByFriends,is_family:t.privacy.isVisibleByFamily,perm_addmeta:t.addMeta};break;case"commenting"in t&&"addMeta"in t:r={photo_ids:i,perm_addmeta:t.addMeta,perm_comment:t.commenting};break;case"privacy"in t:r={photo_ids:i,is_public:t.privacy.isPublic,is_friend:t.privacy.isVisibleByFriends,is_family:t.privacy.isVisibleByFamily};break;case"commenting"in t:r={photo_ids:i,perm_comment:t.commenting};break;case"addMeta"in t:r={photo_ids:i,perm_addmeta:t.addMeta}}return r.full_response=1,e.ModelUpdaters["flickr-photos-setPerms"].run(r,this.appContext)}},attributes:{isPublic:{validator:function(i){return e.AttributeHelpers.validateBoolean(i)},setter:function(i){return e.AttributeHelpers.coerceBoolean(i)},defaultValue:!1},isVisibleByFriends:{validator:function(i){return e.AttributeHelpers.validateBoolean(i)},setter:function(i){return e.AttributeHelpers.coerceBoolean(i)},defaultValue:!1},isVisibleByFamily:{validator:function(i){return e.AttributeHelpers.validateBoolean(i)},setter:function(i){return e.AttributeHelpers.coerceBoolean(i)},defaultValue:!1},permAddMeta:{validator:function(i){return e.AttributeHelpers.validateInteger(i)},setter:function(i){return e.AttributeHelpers.coerceInteger(i)},defaultValue:0},permComment:{validator:function(i){return e.AttributeHelpers.validateInteger(i)},setter:function(i){return e.AttributeHelpers.coerceInteger(i)},defaultValue:0}}})},"@VERSION@",{requires:["flickr-model-registry","flickr-photos-getPerms-fetcher","flickr-photos-setPerms-updater","attribute-helpers"]});YUI.add("flickr-people-getPhotos-fetcher",function(e,o){"use strict";e.namespace("ListFetchers")["flickr-people-getPhotos"]={run:function(t,s){var r=this,p=[s.callAPI("flickr.people.getPhotos",this._processParams(t),!0),s.getModelRegistry("photo-models"),s.getModelRegistry("person-models"),s.getModelRegistry("photostream-models"),s.getModelRegistry("photo-engagement-models"),s.getModelRegistry("photo-stats-models"),s.getModelRegistry("photo-privacy-models")];return t.createCompoundID&&s.getViewer().signedIn&&s.getViewer().nsid&&p.push(s.getModel("person-preferences-models",s.getViewer().nsid)),e.Promise.all(p).then(function(e){return r._processResponse(e,t)},e.FetcherErrorLogger(o))},_processParams:function(o){var t={per_page:o.perPage||20,page:o.page||1,extras:e.APIHelper.request.getRebootPhotoExtras(),get_user_info:1,jump_to:o.withPhotoId||""};return o.id||o.userId?t.user_id=(o.id||o.userId).split("-")[0]:o.pathAlias&&(t.path_alias=o.pathAlias),o.privacyFilter&&(t.privacy_filter=o.privacyFilter),o.viewAs&&(t.view_as=o.viewAs),o.orderBy&&("datetaken"===o.orderBy?t.sort="date-taken-desc":t.sort=o.orderBy),o.safeSearch&&(t.safe_search=o.safeSearch),o.media&&(t.media=o.media),o.withPhotoId&&(t.jump_to=o.withPhotoId),o.contentType&&(t.content_type=o.contentType),t},_processResponse:function(o,t){var s,r,p=o[0],a=o[1],i=o[2],d=o[3],n=o[4],l=o[5],h=o[6],g=p&&p.user?p.user.nsid:null,c=t.id||t.userId;if(!g)throw new Error("API was missing valid nsid");return r={id:g,pathAlias:p.user.pathAlias,owner:e.APIHelper.response.parsePerson(p.user),totalItems:p.photos.total},c&&c!==g&&(r.id=c),o[7]&&(r.id=g+"-"+e.Models["person-preferences-models"].buildContextSuffix(o[7],g)),r.owner=i.addOrUpdate(r.owner),s=e.APIHelper.response.parsePhotos({photos:p.photos.photo,ownerID:p.photos.owner,personModelRegistry:i,photoModelRegistry:a,photoEngagementModelRegistry:n,photoStatsModelRegistry:l,photoPrivacyModelRegistry:h}),r.photoPageList={perPage:p.photos.perpage,page:p.photos.page,pageContent:s,totalItems:parseInt(p.photos.total,10)||0},d.addOrUpdate(r),s}}},"@VERSION@",{requires:["flickr-promise","api-helper","person-preferences-models"],optional:["photo-models","person-models","photostream-models","photo-engagement-models","photo-stats-models","photo-privacy-models"]});YUI.add("photostream-models",function(e,t){function r(e){r.superclass.constructor.call(this,e)}e.Models[this.name]=r,e.extend(r,e.FlickrModelRegistry,{langBundles:this.details.langBundles,name:this.name,remote:{read:function(t){return e.ListFetchers["flickr-people-getPhotos"].run(t,this.appContext)}},attributes:{normalizedId:{readOnly:!0,defaultFn:function(e){return e.split("-")[0]}},displayType:{readOnly:!0,defaultFn:function(){return"photostream"}},title:{readOnly:!0,derivedBy:["owner","normalizedId"],defaultFn:function(e){var t,r=this.appContext.getViewer(),n=this.getValue(e,"normalizedId");return r&&r.nsid===n?this.intlMessage({intlName:"models.YOUR_PHOTOSTREAM"}):(t=this.getValue(e,"owner"))?this.intlMessage({intlName:"models.USER_PHOTOSTREAM",name:t.getValue("displayname")}):this.intlMessage({intlName:"models.PHOTOSTREAM"})}},pathAlias:{validator:function(t,r){return e.AttributeHelpers.validateString(t)},setter:function(t){return e.AttributeHelpers.coerceString(t)||void 0},defaultFn:function(e){return this.getValue(e,"normalizedId")}},owner:{isModel:!0},isOwner:e.PhotoModelHelper.attributes.isOwner,photoPageList:{isCollection:!0,pageFetch:{listFetcher:e.ListFetchers["flickr-people-getPhotos"]}},photoContextList:{isListProxy:!0,contextFetch:{listFetcher:e.ListFetchers["flickr-photos-getContext"],listItemIdField:"photoId"}},url:{readOnly:!0,derivedBy:["owner","normalizedId"],defaultFn:function(e){var t=this.getValue(e,"owner"),r=this.getValue(e,"normalizedId");return"/photos/"+(t?t.getValue("pathAlias"):r)+"/"}},totalItems:{defaultFn:function(){return null}},urlSuffix:{readOnly:!0,defaultFn:function(e){var t,n=r.splitCompoundId(e);return n.orderBy?(t=n.orderBy,n.viewAs?t+="-"+n.viewAs:"dateposted"===n.orderBy&&(t="photostream")):t="photostream",t}}}},{buildCompoundId:function(e,t,r){var n=e;return t&&(n+="-"+t),r&&(t||(n+="-dateposted"),n+="-"+r),n},splitCompoundId:function(e){var t=e.split("-");return{nsid:t[0],orderBy:t[1],viewAs:t[2]}}})},"@VERSION@",{requires:["flickr-model-registry","flickr-promise","flickr-photos-getContext-fetcher","flickr-people-getPhotos-fetcher","photo-model-helper"],langBundles:["models"]});YUI.add("flickr-people-getInfo-fetcher",function(e,r){"use strict";e.namespace("ModelFetchers")["flickr-people-getInfo"]={run:function(s,o){var t=this,i=o.getViewer();return i&&i.signedIn&&(s.id===i.nsid||s.nsid===i.nsid)&&(s.storage=1),new e.FlickrPromise({apiResponse:o.callAPI("flickr.people.getInfo",this._processParams(s,o),!0),personModelRegistry:o.getModelRegistry("person-models"),personRelationshipModelRegistry:o.getModelRegistry("person-relationship-models"),personProfileModelRegistry:o.getModelRegistry("person-profile-models"),personPreferencesModelRegistry:o.getModelRegistry("person-preferences-models"),personGroupsModelRegistry:o.getModelRegistry("person-groups-models"),personNotificationsModelRegistry:o.getModelRegistry("person-notifications-models"),photostreamModelRegistry:o.getModelRegistry("photostream-models")}).then(function(e){return t._processResponse(e,s,o)},e.FetcherErrorLogger(r))},_processParams:function(r,s){var o={datecreate:1};if(o.extras=e.APIHelper.request.getRebootPeopleExtras(),YUI.Env.isServer&&r.id===s.request.probableUser?(o.storage=1,o.extras+=", classic_user_id, active_group_membership, timezone_dst, unified_search_view_pref, photostream_view_order_pref, photostream_view_as_pref, album_view_layout, download_pref, products_features",o.extras+=", is_minor"):s.getViewer().signedIn&&r.id===s.getViewer().nsid&&(o.extras+=", products_features"),r.extras&&"string"==typeof r.extras&&r.extras.length>0&&(o.extras=o.extras+","+r.extras),r.id)o.user_id=r.id;else{if(!r.pathAlias)throw new Error("`fetch` is missing required params.");o.path_alias=r.pathAlias}return r.storage&&(o.storage=r.storage),o.extras||(o.extras=""),o.extras+=", has_stats",o},_processResponse:function(r,s,o){var t,i,a,n=r.apiResponse,d=r.personModelRegistry,p=r.personRelationshipModelRegistry,l=r.personProfileModelRegistry,c=r.personPreferencesModelRegistry,g=r.personGroupsModelRegistry,u=r.personNotificationsModelRegistry,h=r.photostreamModelRegistry,m=n.person,f=o.getViewer(),M=m.id;return a={id:M,pathAlias:m.pathAlias,username:m.username&&m.username._content,realname:m.realname&&m.realname._content,buddyicon:e.APIHelper.response.agnosticizeFarmPathTransferProtocol(m.iconurls),isAdFree:m.isAdFree,isPro:m.ispro,isMinor:m.isMinor,canBuyPro:m.canBuyPro,hasStats:m.hasStats,location:m.location&&m.location._content,hasAdfree:m.hasAdfree,has1TB:m.has1TB,has2TB:m.has2TB,hasUnlimitedStorage:m.hasUnlimitedStorage,hasFreeStandardShipping:m.hasFreeStandardShipping,hasFreeEducationalResources:m.hasFreeEducationalResources,dateCreated:m.datecreate._content,expiringPartner:m.expiringPartner},m.ispro&&(a.proExpireDate=m.expire),d.addOrUpdate(a),u.addOrUpdate({id:M,unreadFlickrMailCount:m.unreadMessages?m.unreadMessages.content:0}),p.addOrUpdate({id:M,pathAlias:m.pathAlias,isContact:m.contact,isFriend:m.friend,isFamily:m.family,isIgnored:m.ignored,isIgnoredBy:m.ignoredby,isRevContact:m.revcontact,isRevFriend:m.revfriend,isRevFamily:m.revfamily}),f&&f.signedIn&&M===f.nsid&&(i={id:M},m.safeSearch&&(i.safeSearch=(m.safeSearch||1)-1),m.viewPrefs&&(i.unifiedSearchViewPref=m.viewPrefs.unifiedSearchViewPref,i.photostreamViewOrderPref=m.viewPrefs.photostreamViewOrderPref,i.photostreamViewAsPref=m.viewPrefs.photostreamViewAsPref,i.albumViewLayoutPref=m.viewPrefs.albumViewLayout),c.exists(M)?c.setValues(M,i):c.add(i)),t={id:M,coverPhotoUrls:e.APIHelper.response.agnosticizeFarmPathTransferProtocol(m.coverphoto_url),photoCount:m.photos.count.content,location:m.location?m.location.content:null},m.storage&&(t.storageUsed=m.storage.used.content,t.storageTotal=m.storage.total.content),m.unreadMessages&&(t.unreadMessages=m.unreadMessages.content),l.addOrUpdate(t),g.addOrUpdate({id:M,memberCount:m.groupMemberships?m.groupMemberships.member:null,moderatorCount:m.groupMemberships?m.groupMemberships.moderator:null,adminCount:m.groupMemberships?m.groupMemberships.admin:null,invitedCount:m.groupMemberships?m.groupMemberships.invited:null}),h.addOrUpdate({id:M,pathAlias:m.pathAlias,owner:d.proxy(M),totalItems:m.photos.count&&m.photos.count.content}),m}}},"@VERSION@",{requires:["flickr-promise"],optional:["person-models","person-relationship-models","person-preferences-models","person-profile-models","person-groups-models","photostream-models","api-helper"]});YUI.add("person-model-helper",function(e){e.PersonModelHelper={attributes:{pathAlias:{validator:function(t,r){return e.AttributeHelpers.validateString(t)},setter:function(t){return e.AttributeHelpers.coerceString(t)||void 0},defaultFn:function(e){return e}},username:{validator:function(t,r){return e.AttributeHelpers.validateString(t)},setter:function(t){return e.AttributeHelpers.coerceString(t)}},realname:{validator:function(t,r){return e.AttributeHelpers.validateString(t)},setter:function(t){return e.AttributeHelpers.coerceString(t)}},displayname:{readOnly:!0,derivedBy:["username","realname"],getter:function(e,t){return this.getValue(t,"realname")||this.getValue(t,"username")}},nsid:{readOnly:!0,defaultFn:function(e){return e}},url:{readOnly:!0,derivedBy:["pathAlias"],defaultFn:function(e){return"/photos/"+this.getValue(e,"pathAlias")+"/"}},isMe:{readOnly:!0,defaultFn:function(e){var t=this.appContext.getViewer();return t.signedIn&&t.nsid===e}}}}},"@VERSION@",{requires:[]});YUI.add("person-models",function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{read:function(t){return e.ModelFetchers["flickr-people-getInfo"].run(t,this.appContext)}},attributes:{pathAlias:e.PersonModelHelper.attributes.pathAlias,username:e.PersonModelHelper.attributes.username,realname:e.PersonModelHelper.attributes.realname,displayname:e.PersonModelHelper.attributes.displayname,nsid:e.PersonModelHelper.attributes.nsid,url:e.PersonModelHelper.attributes.url,isMe:e.PersonModelHelper.attributes.isMe,buddyicon:{},isPro:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)}},isMinor:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)}},proExpireDate:{validator:function(t){return e.AttributeHelpers.validateDate(t)},setter:function(t){return e.AttributeHelpers.coerceDate(t)},serialize:function(e){return e.format("X")},deserialize:function(t){return e.moment(t,"X")}},canBuyPro:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultFn:function(){return!1}},isDeleted:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)}},isAdFree:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)}},isNoAds:{derivedBy:["isPro","isAdFree"],readOnly:!0,getter:function(e,t){var r=this.getValue(t,"isPro"),n=this.getValue(t,"isAdFree");return r||n}},hasStats:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)}},hasAdfree:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)}},has1TB:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)}},has2TB:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)}},hasUnlimitedStorage:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)}},hasFreeStandardShipping:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)}},hasFreeEducationalResources:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)}},dateCreated:{validator:function(t){return e.AttributeHelpers.validateDate(t)},setter:function(t){return e.AttributeHelpers.coerceDate(t)},serialize:function(e){return e.format("X")},deserialize:function(t){return e.moment(t,"X")}},location:{defaultFn:function(){return""}},expiringPartner:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultFn:function(){return!1}}}})},"@VERSION@",{requires:["flickr-model-registry","flickr-people-getInfo-fetcher","attribute-helpers","person-model-helper"]});YUI.add("flickr-photos-getHtmlMeta-fetcher",function(t,o){"use strict";t.namespace("ModelFetchers")["flickr-photos-getHtmlMeta"]={run:function(e,r){var i={photo_id:e.id},s=this;return t.Promise.all([r.callAPI("flickr.photos.getHtmlMeta",i),r.getModelRegistry("photo-head-meta-models")]).then(function(t){return s._processResponse(t,e)},t.FetcherErrorLogger(o))},_processResponse:function(t,o){var e,r=t[0],i=t[1];r&&r.HTMLMETA&&(e={id:r.photoId,title:r.HTMLMETA["og:title"],keywords:r.HTMLMETA.keywords,noindexfollow:r.HTMLMETA.noindexfollow,"og:title":r.HTMLMETA["og:title"],"og:description":r.HTMLMETA["og:description"],"og:type":r.HTMLMETA["og:type"],"og:url":r.HTMLMETA["og:url"],"og:image":r.HTMLMETA["og:image"],"og:image:width":r.HTMLMETA["og:image:width"],"og:image:height":r.HTMLMETA["og:image:height"],"flickr_photos:by":r.HTMLMETA["flickr_photos:by"],"flickr_photos:camera":r.HTMLMETA["flickr_photos:camera"],"flickr_photos:sets":r.HTMLMETA["flickr_photos:sets"],"flickr_photos:groups":r.HTMLMETA["flickr_photos:groups"],"flickr_photos:galleries":r.HTMLMETA["flickr_photos:galleries"],"twitter:card":r.HTMLMETA["twitter:card"],"twitter:description":r.HTMLMETA["twitter:description"],"twitter:app:url:iphone":r.HTMLMETA["twitter:app:url:iphone"],"twitter:creator":r.HTMLMETA["twitter:creator"]},i.addOrUpdate(e))}}},"@VERSION@",{requires:["flickr-promise","api-helper"],optional:["photo-head-meta-models"]});YUI.add("photo-head-meta-models",function(t){function e(t){e.superclass.constructor.call(this,t)}t.Models[this.name]=e,t.extend(e,t.FlickrModelRegistry,{name:this.name,remote:{read:function(e){return t.ModelFetchers["flickr-photos-getHtmlMeta"].run(e,this.appContext)}},getFieldsForDisplay:function(t){var e={},r=this;return["title","noindexfollow","keywords","og:title","og:description","og:type","og:url","og:image","og:image:width","og:image:height","flickr_photos:by","flickr_photos:camera","flickr_photos:sets","flickr_photos:groups","flickr_photos:galleries","twitter:card","twitter:description","twitter:app:url:iphone","twitter:creator","pinterest"].forEach(function(o){var i=r.getValue(t,o);void 0!==i&&(e[o]=i)}),e},attributes:{"og:title":{setter:function(t){return t&&t.replace?t.replace(/"/g,"&quot;"):t}},noindexfollow:{setter:function(t){return t&&t.replace?t.replace(/"/g,"&quot;"):t}},keywords:{setter:function(t){return t&&t.replace?t.replace(/"/g,"&quot;"):t}},title:{setter:function(t){return t&&t.replace?t.replace(/"/g,"&quot;"):t}},"og:description":{setter:function(t){return t&&t.replace?t.replace(/"/g,"&quot;"):t}},"og:type":{},"og:url":{},"og:image":{},"og:image:width":{},"og:image:height":{},"flickr_photos:by":{},"flickr_photos:camera":{},"flickr_photos:sets":{},"flickr_photos:groups":{},"flickr_photos:galleries":{},"twitter:card":{},"twitter:description":{setter:function(t){return t&&t.replace?t.replace(/"/g,"&quot;"):t}},"twitter:app:url:iphone":{},"twitter:creator":{},pinterest:{setter:function(t){return t}}}})},"@VERSION@",{requires:["flickr-model-registry","flickr-promise","flickr-photos-getHtmlMeta-fetcher","flickr-photos-getInfo-fetcher","attribute-helpers"]});YUI.add("photo-notes-models",function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{read:function(t){return e.ModelFetchers["flickr-photos-getInfo"].run(t,this.appContext)}},attributes:{notes:{isCollection:!0}}})},"@VERSION@",{requires:["flickr-model-registry","flickr-photos-getInfo-fetcher"]});YUI.add("flickr-photos-addNotes-creator",function(t,o){"use strict";t.namespace("ModelCreators")["flickr-photos-addNotes"]={run:function(e,r){var s=this;return t.Promise.all([r.callAPI("flickr.photos.notes.add",this._processParams(e)),r.getModelRegistry("photo-notes-models"),r.getModelRegistry("note-models")]).then(function(t){return s._processResponse(t,e)},t.FetcherErrorLogger(o))},_processParams:function(t){return{photo_id:t.photoId,note_x:t.left,note_y:t.top,note_w:t.width,note_h:t.height,note_text:t.text}},_processResponse:function(t,o){var e,r=t[0],s=t[1],a=t[2];return a.addOrUpdate({id:r.note.id,left:o.left,top:o.top,width:o.width,height:o.height,text:o.text,author:o.author,authorName:o.authorName,authorRealName:o.authorRealName,authorIsPro:o.authorIsPro}),e=a.proxy(r.note.id),s.exists(o.photoId)?s.getValue(o.photoId,"notes").appendToList(e):s.add({id:o.photoId,notes:[e]}),e}}},"@VERSION@",{requires:["flickr-promise"],optional:["photo-notes-models","note-models"]});YUI.add("flickr-photos-editNote-updater",function(e,t){"use strict";e.namespace("ModelUpdaters")["flickr-photos-editNote"]={run:function(o,n){var s=this;return e.Promise.all([n.callAPI("flickr.photos.notes.edit",this._processParams(o)),n.getModelRegistry("photo-notes-models"),n.getModelRegistry("note-models")]).then(function(e){return s._processResponse(e,o)},e.FetcherErrorLogger(t))},_processParams:function(e){return{note_id:e.noteId,note_x:e.noteX,note_y:e.noteY,note_w:e.noteW,note_h:e.noteH,note_text:e.noteText}},_processResponse:function(e,t){var o,n=e[0],s=e[1];return(o=e[2].proxy(n.note.id)).setValues({left:n.note.x,top:n.note.y,width:n.note.w,height:n.note.h,text:n.note.content}),s.getValue(n.note.photoId,"notes").getFromListByID(n.note.id).setValues({left:n.note.x,top:n.note.y,width:n.note.w,height:n.note.h,text:n.note.content}),o}}},"@VERSION@",{requires:["flickr-promise"],optional:["photo-notes-models","note-models"]});YUI.add("flickr-photos-deleteNote-deletor",function(e,o){"use strict";e.namespace("ModelDeletors")["flickr-photos-deleteNote"]={run:function(t,r){var l={note_id:t};return r.callAPI("flickr.photos.notes.delete",l).then(null,e.FetcherErrorLogger(o))}}},"@VERSION@",{requires:["flickr-promise"],optional:[]});YUI.add("note-models",function(t){function e(t){e.superclass.constructor.call(this,t)}t.Models[this.name]=e,t.extend(e,t.FlickrModelRegistry,{name:this.name,remote:{create:function(e){return t.ModelCreators["flickr-photos-addNotes"].run(e,this.appContext)},update:function(e,r){var n;return n={noteId:e,noteX:this.getValue(e,"left"),noteY:this.getValue(e,"top"),noteW:this.getValue(e,"width"),noteH:this.getValue(e,"height"),noteText:this.getValue(e,"text")},t.ModelUpdaters["flickr-photos-editNote"].run(n,this.appContext)},delete:function(e){return t.ModelDeletors["flickr-photos-deleteNote"].run(e,this.appContext)}},attributes:{author:{setter:function(t){return t}},authorName:{setter:function(t){return t}},authorRealName:{setter:function(t){return t}},authorIsPro:{defaultValue:!1,setter:function(e){return t.AttributeHelpers.coerceBoolean(e)}},left:{validator:function(e){return t.AttributeHelpers.validateInteger(e)},setter:function(e){return t.AttributeHelpers.coerceInteger(e)}},top:{validator:function(e){return t.AttributeHelpers.validateInteger(e)},setter:function(e){return t.AttributeHelpers.coerceInteger(e)}},width:{validator:function(e){return t.AttributeHelpers.validateInteger(e)},setter:function(e){return t.AttributeHelpers.coerceInteger(e)}},height:{validator:function(e){return t.AttributeHelpers.validateInteger(e)},setter:function(e){return t.AttributeHelpers.coerceInteger(e)}},text:{setter:function(t){return t}}}})},"@VERSION@",{requires:["flickr-model-registry","flickr-photos-addNotes-creator","flickr-photos-editNote-updater","flickr-photos-deleteNote-deletor","attribute-helpers"]});YUI.add("flickr-photos-deleteAutotags-deletor",function(e,t){"use strict";e.namespace("ModelDeletors")["flickr-photos-deleteAutotags"]={run:function(o,r){return r.callAPI("flickr.photos.deleteAutotags",o).then(null,e.FetcherErrorLogger(t))}}},"@VERSION@",{requires:["flickr-promise"],optional:[]});YUI.add("autotag-models",function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{delete:function(t){return e.ModelDeletors["flickr-photos-deleteAutotags"].run(t,this.appContext)}},attributes:{autotagValue:{validator:function(t){return e.AttributeHelpers.validateString(t)},setter:function(t){return e.AttributeHelpers.coerceString(t)}},score:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)}},isPrivate:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},searchUrl:{derivedBy:["autotagValue"],readOnly:!0,defaultFn:function(e){return"/search/?q="+this.getValue(e,"autotagValue")}}}})},"@VERSION@",{requires:["flickr-model-registry","flickr-photos-deleteAutotags-deletor"]});YUI.add("photo-autotags-models",function(t){function e(t){e.superclass.constructor.call(this,t)}t.Models[this.name]=e,t.extend(e,t.FlickrModelRegistry,{name:this.name,remote:{delete:function(e){return t.ModelDeletors["flickr-photos-deleteAutotags"].run(e,this.appContext)}},attributes:{autotags:{isCollection:!0}}})},"@VERSION@",{requires:["flickr-model-registry","flickr-photos-deleteAutotags-deletor"]});YUI.add("flickr-photos-getInfo-fetcher",function(o,t){"use strict";o.namespace("ModelFetchers")["flickr-photos-getInfo"]={run:function(e,s){var r,i=this;return s.flipper.isFlipped("enable-scrappy-photo-page")&&(e.scrappy=!0),r=this._processParams(e),new o.FlickrPromise({apiResponse:s.callAPI("flickr.photos.getInfo",r,!0),photoRegistry:s.getModelRegistry("photo-models"),personRegistry:s.getModelRegistry("person-models"),personRelationshipRegistry:s.getModelRegistry("person-relationship-models"),photoEngagementRegistry:s.getModelRegistry("photo-engagement-models"),photoStatsRegistry:s.getModelRegistry("photo-stats-models"),photoPrivacyRegistry:s.getModelRegistry("photo-privacy-models"),photoNotesRegistry:s.getModelRegistry("photo-notes-models"),noteRegistry:s.getModelRegistry("note-models"),photoGeoRegistry:s.getModelRegistry("photo-geo-models"),photoLocationRegistry:s.getModelRegistry("photo-location-models"),photoHeadMetaRegistry:s.getModelRegistry("photo-head-meta-models"),groupRegistry:s.getModelRegistry("group-models"),contextsRegistry:s.getModelRegistry("photo-contexts-models"),favoriteRegistry:s.getModelRegistry("favorite-models"),galleryRegistry:s.getModelRegistry("gallery-models"),groupsPoolRegistry:s.getModelRegistry("group-pool-models"),setRegistry:s.getModelRegistry("set-models"),photostreamRegistry:s.getModelRegistry("photostream-models")}).then(function(o){return i._processResponse(o,s.flipper,r)},o.FetcherErrorLogger(t))},_processParams:function(t){var e,s;return e=["sizes","icon_urls","ignored","rev_ignored","rev_contacts","venue","datecreate"].join(","),e=e+","+o.APIHelper.request.getRebootPhotoExtras(),s={datecreate:1,extras:e,photo_id:t.id,get_contexts:1,primary_photo_extras:"url_sq, url_t, url_s, url_m"},t.userId?s.user_id=t.userId:t.pathAlias&&(s.path_alias=t.pathAlias),t.context&&(s.context=t.context,s.num_prev=1,s.num_next=1),t.scrappy&&(o.APIHelper.request.addStaticMapsParams(s),delete s.get_contexts,delete s.primary_photo_extras,delete s.context),s},_processResponse:function(t,e,s){var r,i,p,n,a,h,d,l,g,c,y=t.apiResponse,m=t.photoRegistry,R=t.personRegistry,u=t.personRelationshipRegistry,M=t.photoEngagementRegistry,f=t.photoStatsRegistry,w=t.photoPrivacyRegistry,v=t.photoNotesRegistry,T=t.noteRegistry,x=t.photoGeoRegistry,A=t.photoLocationRegistry,H=t.photoHeadMetaRegistry,P=t.groupRegistry,_={},k=[];if(!y.photo.sizes)throw new Error("Missing photo sizes from flickr.photos.getInfo call.");i={id:y.photo.id,title:y.photo.title.content,description:y.photo.description.content,sizes:o.APIHelper.response.parsePhotoSize(y.photo.sizes.size,!0),needsInterstitial:y.photo.needsInterstitial,canComment:y.photo.editability.cancomment,canPublicComment:y.photo.publiceditability.cancomment,canAddMeta:y.photo.editability.canaddmeta,safetyLevel:y.photo.safetyLevel,license:y.photo.license,mediaType:y.photo.media,secret:y.photo.secret,isHD:o.APIHelper.response.isHD(y.photo.sizes.size),rotation:y.photo.rotation,hasInvalidColorspaceForPrint:y.photo.hasInvalidColorspaceForPrint,oWidth:y.photo.oWidth?parseInt(y.photo.oWidth,10):"",oHeight:y.photo.oHeight?parseInt(y.photo.oHeight,10):"",visibilitySource:y.photo.visibilitySource,isVideoPending:y.photo.video?y.photo.video.pending:0},p={id:y.photo.owner.nsid,username:y.photo.owner.username,realname:y.photo.owner.realname,pathAlias:y.photo.owner.pathAlias,buddyicon:o.APIHelper.response.agnosticizeFarmPathTransferProtocol(y.photo.owner.iconurls),isAdFree:y.photo.owner.isAdFree,isPro:y.photo.owner.ispro,dateCreated:y.photo.owner.datecreate,location:y.photo.owner.location},n={id:y.photo.owner.nsid,pathAlias:y.photo.owner.pathAlias,isContact:y.photo.contactIscontact,isFamily:y.photo.contactIsfamily,isFriend:y.photo.contactIsfriend,isIgnored:y.photo.owner.isignored,isIgnoredBy:y.photo.owner.revIgnored,isRevContact:y.photo.owner.revContact,isRevFamily:y.photo.owner.revFamily,isRevFriend:y.photo.owner.revFriend},a={id:y.photo.id,ownerNsid:y.photo.owner.nsid,isFaved:y.photo.isfavorite||!1,canShare:y.photo.usage.canshare,canDownload:y.photo.usage.candownload,commentCount:y.photo.comments.content,noteCount:y.photo.notes&&y.photo.notes.note&&y.photo.notes.note.length,faveCount:y.photo.countFaves,viewCount:y.photo.views},h={id:y.photo.id,dateTaken:y.photo.dates.taken,datePosted:y.photo.dates.posted,takenGranularity:y.photo.dates.takengranularity,isDateTakenUnknown:y.photo.datetakenunknown||"1"===y.photo.datetakenunknown||1===y.photo.datetakenunknown},l={id:y.photo.id,title:y.photo.HTMLMETA["og:title"],noindexfollow:y.photo.owner.noindexfollow,keywords:y.photo.HTMLMETA.keywords,"og:title":y.photo.HTMLMETA["og:title"],"og:description":y.photo.HTMLMETA["og:description"],"og:type":y.photo.HTMLMETA["og:type"],"og:url":y.photo.HTMLMETA["og:url"],"og:image":y.photo.HTMLMETA["og:image"],"og:image:width":y.photo.HTMLMETA["og:image:width"],"og:image:height":y.photo.HTMLMETA["og:image:height"],"flickr_photos:by":y.photo.HTMLMETA["flickr_photos:by"],"flickr_photos:camera":y.photo.HTMLMETA["flickr_photos:camera"],"flickr_photos:sets":y.photo.HTMLMETA["flickr_photos:sets"],"flickr_photos:groups":y.photo.HTMLMETA["flickr_photos:groups"],"flickr_photos:galleries":y.photo.HTMLMETA["flickr_photos:galleries"],"twitter:card":y.photo.HTMLMETA["twitter:card"],"twitter:description":y.photo.HTMLMETA["twitter:description"],"twitter:app:url:iphone":y.photo.HTMLMETA["twitter:app:url:iphone"],"twitter:creator":y.photo.HTMLMETA["twitter:creator"],pinterest:y.photo.HTMLMETA.pinterest},d={id:y.photo.id,isPublic:y.photo.visibility.ispublic,isVisibleByFriends:y.photo.visibility.isfriend,isVisibleByFamily:y.photo.visibility.isfamily,permAddMeta:y.photo.permissions?y.photo.permissions.permaddmeta:0,permComment:y.photo.permissions?y.photo.permissions.permcomment:0},y.photo&&y.photo.notes&&y.photo.notes.note&&o.Array(y.photo.notes.note).forEach(function(o){k.push(T.addOrUpdate({id:o.id,author:o.author,authorName:o.authorname,authorRealName:o.authorrealname,authorIsPro:o.authorispro,left:o.x,top:o.y,width:o.w,height:o.h,text:o.content}))}),g=o.ModelFetchers["flickr-photos-getLocation"].mapResponse(y,x),i.owner=R.addOrUpdate(p),i.engagement=M.addOrUpdate(a),u.addOrUpdate(n),c=m.addOrUpdate(i),f.addOrUpdate(h),w.addOrUpdate(d),v.addOrUpdate({id:i.id,notes:k}),H.addOrUpdate(l),A.addOrUpdate(g),y.photo.contexts&&(r=t.contextsRegistry,_.faves=t.favoriteRegistry,_.gallery=t.galleryRegistry,_.pool=t.groupsPoolRegistry,_.set=t.setRegistry,_.stream=t.photostreamRegistry,(function(t){var e=t.photoModel,s=t.contextRegistries,r=t.contextsResponse,i=t.personRegistry,p=t.contextsRegistry,n=t.photoEngagementRegistry,a=t.photoStatsRegistry,h=t.groupRegistry,d=t.apiParams,l=[];o.Object.each(s,function(t,s){r[s]&&o.Array.each(r[s],function(s){o.APIHelper.response.addContextToRegistry(s,t,i,h),l.push(t.proxy(s.id)),d.context&&(function(){var r,p,h,l,g,c,y,m,R;p=!!(r=t.getValue(s.id,"photoContextList")).hasMinBoundary&&r.hasMinBoundary(),h=!!r.hasMaxBoundary&&r.hasMaxBoundary(),l=r.getList(),c=s.nextphotos,y=s.prevphotos,m=c?o.APIHelper.response.parsePhotos({photos:c.photo,personModelRegistry:i,photoModelRegistry:e.registry,photoEngagementModelRegistry:n,photoStatsModelRegistry:a}):[],((R=y?o.APIHelper.response.parsePhotos({photos:y.photo,personModelRegistry:i,photoModelRegistry:e.registry,photoEngagementModelRegistry:n,photoStatsModelRegistry:a}):[]).length||m.length)&&(g=o.APIHelper.response.addOrReplaceListByContext({model:e,next:m,prev:R.reverse(),current:l,hasMin:p,hasMax:h,numNext:d.num_next,numPrev:d.num_prev})),t.setValue(s.id,"photoContextList",g)})()})}),p.exists(e.id)||(p.add({id:e.id,totalGroups:r.pool?r.pool.length:0,totalSets:r.set?r.set.length:0,totalGalleries:r.gallery?r.gallery.length:0}),p.setValue(e.id,"contexts",l))})({photoModel:c,contextRegistries:_,contextsResponse:y.photo.contexts,personRegistry:R,contextsRegistry:r,photoEngagementRegistry:M,photoStatsRegistry:f,groupRegistry:P,apiParams:s}))}}},"@VERSION@",{requires:["flickr-promise","api-helper","flickr-photos-getLocation-fetcher"],optional:["photo-models","person-models","person-relationship-models","photo-engagement-models","photo-stats-models","photo-geo-models","photo-location-models","photo-head-meta-models","note-models","photo-notes-models","autotag-models","photo-autotags-models"]});